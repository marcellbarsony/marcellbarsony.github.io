+++
title = "TryHackMe - Basic Pentesting"
date = 2025-07-10

[taxonomies]
tags = ["tryhackme", "authentication", "smb",  "hydra" ]
+++

![TODO](/pictures/articles/thm/basic-pentesting/00-cover.png)

**Basic Pentesting** is an introductory machine that walks through common
enumeration and exploitation techniques. This lab demonstrates how exposed
services, weak passwords, mismanaged credentials, and leaving sensitive files
accessible can be leveraged go gain access to the machine.


<!-- more -->


# Enumeration

<!-- Enumeration {{{-->

The nmap scan discovered the following open ports on the target machine.

- 22 - OpenSSH
- 80 - Apache HTTP Server
- 139 - SMB (Samba)
- 445 - SMB (Samba)

![a](/pictures/articles/thm/basic-pentesting/01-nmap.png)

Gobuster found a directory called `/development` that should be investigated
further.

![a](/pictures/articles/thm/basic-pentesting/02-gobuster.png)

The directory contains two files: `dev.txt` and `j.txt`.

![a](/pictures/articles/thm/basic-pentesting/03-development.png)

`dev.txt` indicates that Apache Struts 2.5.12 is running on the server,
and that SMB is also configured.

![a](/pictures/articles/thm/basic-pentesting/04-dev.png)

`j.txt` implies that `J` is not following strong password guidelines.

![a](/pictures/articles/thm/basic-pentesting/05-j.png)

Since the server is running Samba, it is possible to connect to its file share
as an anonymous user.

The share contains only a single file named `staff.txt`, which can be retrieved
to examine its contents.

![a](/pictures/articles/thm/basic-pentesting/06-smbclient.png)

The file discloses two possible usernames: `Jan` and `Kay`.

![a](/pictures/articles/thm/basic-pentesting/07-staff.png)

<!-- }}} -->

# Exploitation

<!-- Exploitation {{{-->

With the obtained usernames it is now possible to brute force their SSH login
password.

Hydra has found a password (`armando`) for the user `Jan`.

![a](/pictures/articles/thm/basic-pentesting/08-hydra.png)

It is indeed possible to log in with the acquired credentials.

![a](/pictures/articles/thm/basic-pentesting/09-shh-jan.png)

After investigating the other user's (`Kay`) home directory,
it contains a RSA key pair that could be used to authenticate to the target
machine as the user `Kay`.

![a](/pictures/articles/thm/basic-pentesting/10-id_rsa.png)

Unfortunately, the authentication requires a password. To overcome this,
the RSA key needs to be converted into a format that John the Ripper can crack.

![a](/pictures/articles/thm/basic-pentesting/11-rsa.png)

With the cracked password it is now possible to log in as `Kay`.

![a](/pictures/articles/thm/basic-pentesting/12-ssh-rsa.png)

The final flag is located in the user's home directory.

![a](/pictures/articles/thm/basic-pentesting/13-flag.png)

<!-- }}} -->

# Mitigation

<!-- Mitigation {{{-->

1. Password policy
    - Follow strong password policy guidelines and use strong and unique
    passwords

2. SMB access
    - Restrict SMB access to authenticated users only

3. Brute force attempts
    - Monitor brute force attempts and apply rate limits using tools like
    fail2ban

4. Update software
    - Keep software (such as Apache Struts) up to date

5. SSH authentication
    - Disable SSH password authentication and use a key-based authentication
    instead

<!-- }}} -->
